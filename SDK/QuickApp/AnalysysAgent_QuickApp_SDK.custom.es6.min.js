import e from"@system.fetch";import t from"@system.storage";import a from"@system.device";import r from"@system.network";import n from"@system.router";import s from"@system.app";var o={base:{outer:["appid","xwho","xwhat","xwhen","xcontext"],xcontext:["$lib","$lib_version","$platform","$debug","$is_login"]},$startup:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated","$is_first_time","$scene"]},$track:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated"]},$pageview:{xcontext:["$brand","$model","$os","$os_version","$browser","$browser_version","$network","$screen_width","$screen_height","$utm_campaign_id","$utm_campaign","$utm_medium","$utm_source","$utm_content","$utm_term","$is_first_day","$time_zone","$language","$session_id","$is_time_calibrated","$referrer","$scene","$startup_time","$url","$share_id","$share_path","$share_level"]},$alias:{xcontext:["$original_id"]},$getPresetProperties:{xcontext:["$time_zone","$language","$screen_width","$screen_height","$network","$first_visit_time","$brand","$model","$os","$session_id"]},$userClick:{xcontext:["$element_content","$element_id","$element_type","$element_name","$url","$is_first_day","$session_id","$is_time_calibrated"]}},u={base:{appid:"",$debug:0,$lib_version:"4.3.0",$lib:"Quickapp",uploadURL:"",auto:!0,autoProfile:!0,encryptType:0,autoShare:!1,$share_level:"",$share_path:"",$share_id:"",appProperty:null,allowTimeCheck:!1,maxDiffTimeInterval:30,logflag:!1,userObj:{},userPageObj:{},autoTrack:!1,dataType:""},status:{code:200,FnName:"",key:"",value:"",errorCode:"",successCode:""},system:{system:{},netWork:{},scene:null},isStartUp:!1,FnCatch:[],FnSuperCatch:[],keywords:o.base.xcontext,baseJson:o.base.outer,sendNum:1800},i=Object.freeze({__proto__:null,request:function(t){t.responseType=t.dataType,delete t.dataType,e.fetch(t)}}),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},p=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),y=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},m=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)},f=Object.freeze({__proto__:null,getStoragePromise:function(e){return new Promise((function(a,r){try{t.get({key:e,success:function(e){a(e)},fail:function(e){r(e)}})}catch(e){}})).catch((function(){}))},setStoragePromise:function(e,a){return new Promise((function(r,n){"object"==(void 0===a?"undefined":c(a))&&(a=JSON.stringify(a));try{t.set({key:e,value:a,success:function(){r(200)},fail:function(){n(400)}})}catch(e){}})).catch((function(e){}))}}),v=Object.freeze({__proto__:null,systemPromise:function(){return new Promise((function(e,t){a.getInfo({success:function(t){var a={brand:t.brand,model:t.model,screenWidth:t.screenWidth,screenHeight:t.screenHeight,language:t.language,version:t.platformVersionCode,browser:t.platformVersionName,system:t.osType+" "+t.osVersionCode};e(a)},fail:function(t){e({brand:"",model:"",screenWidth:"",screenHeight:"",language:"",version:"",system:""})}})})).catch((function(e){}))}}),g=Object.freeze({__proto__:null,netWorkPromise:function(){return new Promise((function(e,t){r.getType({success:function(t){var a={networkType:t.type};e(a)},fail:function(t){e({networkType:""})}})})).catch((function(e){}))}}),d=[];function h(){var e=s.getInfo();return"object"==(void 0===e?"undefined":c(e))&&"object"==c(e.source)&&e.source.type||""}var b=Object.freeze({__proto__:null,getScene:h,getPackageName:function(){var e=s.getInfo();return"object"==(void 0===e?"undefined":c(e))&&"object"==c(e.source)&&e.source.packageName||""},getPath:function(){var e=n.getState(),t="object"==(void 0===e?"undefined":c(e))?e.path:"";return d.push(t),t},getTitle:function(){var e=n.getState();return"object"==(void 0===e?"undefined":c(e))?e.name:""},getReferer:function(){return d.length>-1?d[d.length-1]:h()}}),T=new function e(){var t=this;l(this,e),this.AppObj={},this.Fetch=i,this.Storage=f,this.System=v,this.Network=g,this.Router=b,this.setPublicApp=function(e){t.AppObj=e},this.getPublicApp=function(){return t.AppObj}},S=T.Storage.getStoragePromise,A=T.Storage.setStoragePromise,_=new(function(){function e(){l(this,e),this.local={},this.Session={},this.localStatus=!1,this.getStoragePromise=T.Storage.getStoragePromise}return p(e,[{key:"initLocalData",value:function(){var e=this;return S("FZ_STROAGE").then((function(t){if(!e.localStatus){if(e.localStatus=!0,t||(t={}),"string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}e.local=Object.assign(t,e.local),A("FZ_STROAGE",e.local).then((function(){}),(function(e){})).catch((function(e){}))}}),(function(){e.local={}})).catch((function(e){}))}},{key:"setData",value:function(e,t){this.Session[e]=t}},{key:"getData",value:function(e){return"undefind"===this.Session[e]?"":this.Session[e]}},{key:"removeData",value:function(e){"undefind"!==this.Session[e]&&delete this.Session[e]}},{key:"clearData",value:function(){this.Session={}}},{key:"setLocal",value:function(e,t){this.local[e]=t;var a=this.local;A("FZ_STROAGE",a).then((function(){}),(function(e){})).catch((function(e){}))}},{key:"getLocal",value:function(e){return this.local[e]}},{key:"removeLocal",value:function(e){if("undefind"!==this.local[e]){delete this.local[e];var t=this.local;A("FZ_STROAGE",t).then((function(){}),(function(){})).catch((function(e){}))}}}]),e}()),$=new(function(){function e(){l(this,e)}return p(e,[{key:"paramType",value:function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","")}},{key:"delEmpty",value:function(e){var t=this,a=this.deepClone(e);return"Object"!==this.paramType(a)?{}:(Object.keys(a).forEach((function(e){var r=a[e];"Object"===t.paramType(r)&&(a[e]=t.delEmpty(a[e]),0===Object.keys(a[e]).length&&delete a[e]),""===r&&delete a[e]})),a)}},{key:"deepClone",value:function(e){var t=Object.getPrototypeOf(e);return Object.assign({},Object.create(t),e)}},{key:"mergeMsg",value:function(e,t){Object.assign(t,e)}},{key:"checkObj",value:function(e,t){var a={};if(1===arguments.length&&e.constructor===Array){for(var r=0;r<e.length;r++)a[e[r]]="";return a}return 1===arguments.length&&e.constructor===String?(a[e]=t||"",a):(arguments.length>1&&e.constructor!==Object?a[e]=t:a=e,a)}},{key:"isFristDay",value:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var r=e.getDate(),n=t+""+a+(r=r<10?"0"+r:r),s=_.getLocal("FRISTDAY");return!(s&&n!==s||(s||_.setLocal("FRISTDAY",n),0))}},{key:"isFristTime",value:function(){var e=!1!==_.getLocal("FRISTIME");return e&&_.setLocal("FRISTIME",!1),e}},{key:"isEmptyObject",value:function(e){return!(Object.keys(e).length>0)}},{key:"setFristDay",value:function(){if("String"!==this.paramType(_.getLocal("FRISTDAY"))){var e=this.format(new Date,"yyyyMMdd");u.base.allowTimeCheck&&u.base.logflag&&(e=this.format(new Date(+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)),"yyyyMMdd")),_.setLocal("FRISTDAY",e)}}},{key:"setFristTime",value:function(){"Boolean"!==this.paramType(_.getLocal("FRISTIME"))&&_.setLocal("FRISTIME",!0)}},{key:"delFristDay",value:function(){_.removeLocal("FRISTDAY")}},{key:"delFristTime",value:function(){_.removeLocal("FRISTIME")}},{key:"checkURL",value:function(e){var t=e;return 1==new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(t)}},{key:"firstVisitTime",value:function(){var e=!1!==_.getLocal("FIRSTVISITTIME");return e&&_.setLocal("FIRSTVISITTIME",!1),e}},{key:"toDeepObj",value:function(e,t,a){var r={};if("String"===this.paramType(e))return this.keyValueToObje(e,t);if("Array"===this.paramType(e))return this.ArrayToObj(e);if("Object"===this.paramType(e))for(var n in e)r[n]=this.toDeepObj(e[n]);return r}},{key:"ArrayToObj",value:function(e){for(var t={},a=0;a<e.length;a++)t[e[a]]="";return t}},{key:"keyValueToObje",value:function(e,t){var a={};return a[e]=t,a}},{key:"toObj",value:function(e,t,a){var r={};return"String"===this.paramType(e)?r=this.keyValueToObje(e,t):"Array"===this.paramType(e)?r=this.ArrayToObj(e):"Object"===this.paramType(e)?e:r}},{key:"objMerge",value:function(e,t){if("Object"!==this.paramType(e)||"Object"!==this.paramType(t))return e;var a={};for(var r in e)a[r]=e[r];for(var r in t)a[r]&&"Object"===this.paramType(a[r])&&"Object"===this.paramType(t[r])?a[r]=this.objMerge(a[r],t[r]):"Array"===this.paramType(a[r])&&"Array"===this.paramType(t[r])?a[r]=this.arrayMergeUnique(a[r],t[r]):a[r]=t[r];return a}},{key:"arrayUnique",value:function(e){for(var t=[],a={},r=0;r<e.length;r++)a[e[r]]||(a[e[r]]=!0,t.push(e[r]));return t}},{key:"arrayMerge",value:function(e,t){return e.push.apply(e,t),e}},{key:"arrayMergeUnique",value:function(e,t){return e.push.apply(e,t),this.arrayUnique(e)}},{key:"format",value:function(e,t){var a=e.getTimezoneOffset(),r={"M+":(e=new Date(e.getTime()+60*a*1e3+288e5)).getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,3==RegExp.$1.length?(""+r[n]).length<3?("00"+r[n]).substr(("00"+r[n]).length-3,("00"+r[n]).length):r[n]:("00"+r[n]).substr((""+r[n]).length)));return t}},{key:"objHasKay",value:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{key:"clientTimeZone",value:function(){var e=(new Date).getTimezoneOffset(),t=parseInt(e/60),a=e%60,r="-";return(t<=0||a<0)&&(r="+",t=-t,a<0&&(a=-a)),1==(t+="").length&&(t="0"+t),1==(a+="").length&&(a="0"+a),r+t+":"+a}},{key:"objInArray",value:function(e){var t=[];return t.push(e),t}},{key:"stringSlice",value:function(e,t){return e.slice(0,t)}}]),e}()),k={common:"{FN}:Property key invalid, nonsupport value: $lib/$lib_version/$platform/$first_visit_time/$debug/$is_login \ncurrent KEY:{KEY}",60001:"{FN}:Property key invalid, support type: String \ncurrent key:{KEY}\ncurrent keyType:{KEYTYPE}",60002:"{FN}:Property value invalid of key[{KEY}], support type: Number \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60003:"{FN}:Property value invalid of key[{KEY}], support type: Boolean \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60004:"{FN}:Property value invalid of key[{KEY}], support type: Array \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",60005:"{FN}:The length of the property[{KEY}] value (string[{VALUE}]) needs to be 1-255 !",60006:"Please set appkey first.",60007:"Please set uploadURL first.",60008:"Send message failed.",60009:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-125 !",600010:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-99 !",600011:"{FN}:[{KEY}] does not conform to naming rules!",600012:"{FN}:Property key invalid, nonsupport value: $lib/$lib_version/$platform/$first_visit_time/$debug/$is_login \ncurrent KEY:{KEY}",600013:"{FN}:Property value invalid of key[{KEY}], support type: Array with String as its internal element \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600016:"{FN}:Property value invalid of key[{KEY}], support type: Object \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600017:"{FN}:The length of the property key (string[{KEY}]) needs to be 1-255 !",600018:"{FN}:Property value invalid of key[{KEY}] invalid, support type: String \ncurrent value:{VALUE}\ncurrent type: {VALUETYPE}",600019:"{FN}:The length of the property[{KEY}] value (string[{VALUE}]) needs to be 1-255 !",600020:"DebugMode only can be 0,1,2",600021:"{FN}:Property value invalid of key[{KEY}], support type: Object, Object.keys length needs to be 1-499 \ncurrent length:{VALUE}\n"},R={common:"",20001:"Send message success",20002:"{FN}: set success ({VALUE})",20003:"{FN}:({VALUE}) delete success",20004:"{FN}:clear success",20005:"{FN}:reset success",20006:"set appkey success. current appkey : {VALUE}",20007:"Init Analysys "+u.base.$lib+" sdk success, version : {VALUE}",20008:"set uploadURL success. current uploadURL : {VALUE}",20009:"{FN}:[{KEY}] : get failed",20010:"{FN}:[{KEY}] : get success. ({VALUE})",20011:"{FN}:({VALUE}) delete failed",20012:"Send Message to Server: {KEY} \ndata:{VALUE}",20013:"收到服务器的时间: {VALUE} \n本地时间: {KEY} \n时间相差:  {FN} \n数据将会进行时间校准"};function L(e){if(1===u.base.$debug||2===u.base.$debug){var t=u.status,a=t.successCode,r=t.FnName,n=t.key,s=t.value,o=(R[a]||R.common).replace(/{FN}/,r).replace(/{KEY}/g,n).replace(/{VALUE}/g,s);if(e&&(o=e),!o)return;if("Object"===$.paramType(console)&&console.log)try{return console.log.apply(console,o)}catch(e){console.log(o)}}}function E(){var e=u.status,t=e.errorCode,a=e.FnName,r=e.key,n=JSON.stringify(e.value),s=$.paramType(e.value),o=$.paramType(r),i=(k[t]||k.common).replace(/{FN}/g,a).replace(/{KEY}/g,JSON.stringify(r)).replace(/{VALUE}/g,n).replace(/{VALUETYPE}/g,s).replace(/{KEYTYPE}/g,o);1!==u.base.$debug&&2!==u.base.$debug||console.warn(i)}var I=new(function(){function e(){l(this,e)}return p(e,[{key:"isString",value:function(e){return u.status.errorCode="60001","String"===$.paramType(e)}},{key:"isNumber",value:function(e){return u.status.errorCode="60002","Number"===$.paramType(e)}},{key:"isBoolean",value:function(e){return u.status.errorCode="60003","Boolean"===$.paramType(e)}},{key:"isObject",value:function(e){return"Object"===$.paramType(e)}},{key:"lengthRule",value:function(e,t,a){this.isNumber(a)||(a=1/0);var r=!0;return this.isNumber(t)&&e.length&&e.length>t&&e.length<a+1||(u.status.errorCode="60005",r=!1),r}},{key:"nimLength",value:function(e){return this.lengthRule(e,0)}},{key:"length99",value:function(e){var t=this.lengthRule(e,0,99);return t||(u.status.errorCode="600010"),t}},{key:"length125",value:function(e){var t=this.lengthRule(e,0,125);return t||(u.status.errorCode="60009"),t}},{key:"length255",value:function(e){if(!(e||this.isString(e)||this.isNumber(e)||this.isBoolean(e)))return u.status.errorCode="60005",!1;"String"!==$.paramType(e)&&(e=e.toString());var t=this.lengthRule(e,0,255);return t||(u.status.errorCode="600019"),t}},{key:"keyLength255",value:function(e){var t=this.length255(e);return t||(u.status.errorCode="600017"),t}},{key:"isURL",value:function(e){var t=e;return 1==new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(t)||(u.status.errorCode="60006",!1)}},{key:"isDebug",value:function(e){return!(!this.isNumber(e)||0!==e&&1!==e&&2!==e)}},{key:"notObject",value:function(e){return!this.isObject(e)}},{key:"notSpecialCharacters",value:function(e){return!(new RegExp("[\\u4E00-\\u9FA5]|[\\uFE30-\\uFFA0]","gi").test(e)||!/^[$a-zA-Z][a-zA-Z0-9_$]{0,}$/.test(e))||(u.status.errorCode="600011",!1)}},{key:"isArrayString",value:function(e){if("Array"===$.paramType(e))for(var t=0;t<e.length;t++){if(u.status.value=e[t],"String"!==$.paramType(e[t]))return u.status.errorCode="600013",!1;if(!this.length255(e[t]))return!1}return!0}},{key:"keywords",value:function(e){var t=u.keywords;return u.status.errorCode="600012",!(t.indexOf(e)>-1)}}]),e}());function O(e,t){var a=e;function r(e,t){return e<<t|e>>>32-t}function n(e,t){var a,r,n,s,o;return n=2147483648&e,s=2147483648&t,o=(1073741823&e)+(1073741823&t),(a=1073741824&e)&(r=1073741824&t)?2147483648^o^n^s:a|r?1073741824&o?3221225472^o^n^s:1073741824^o^n^s:o^n^s}function s(e,t,a,s,o,u,i){return e=n(e,n(n(function(e,t,a){return e&t|~e&a}(t,a,s),o),i)),n(r(e,u),t)}function o(e,t,a,s,o,u,i){return e=n(e,n(n(function(e,t,a){return e&a|t&~a}(t,a,s),o),i)),n(r(e,u),t)}function u(e,t,a,s,o,u,i){return e=n(e,n(n(function(e,t,a){return e^t^a}(t,a,s),o),i)),n(r(e,u),t)}function i(e,t,a,s,o,u,i){return e=n(e,n(n(function(e,t,a){return t^(e|~a)}(t,a,s),o),i)),n(r(e,u),t)}function c(e){var t="",a="",r=void 0;for(r=0;r<=3;r++)t+=(a="0"+(e>>>8*r&255).toString(16)).substr(a.length-2,2);return t}var l=Array(),p=void 0,y=void 0,m=void 0,f=void 0,v=void 0,g=void 0,d=void 0,h=void 0,b=void 0;for(l=function(e){for(var t=void 0,a=e.length,r=a+8,n=16*((r-r%64)/64+1),s=Array(n-1),o=0,u=0;u<a;)o=u%4*8,s[t=(u-u%4)/4]=s[t]|e.charCodeAt(u)<<o,u++;return o=u%4*8,s[t=(u-u%4)/4]=s[t]|128<<o,s[n-2]=a<<3,s[n-1]=a>>>29,s}(a),g=1732584193,d=4023233417,h=2562383102,b=271733878,p=0;p<l.length;p+=16)y=g,m=d,f=h,v=b,g=s(g,d,h,b,l[p+0],7,3614090360),b=s(b,g,d,h,l[p+1],12,3905402710),h=s(h,b,g,d,l[p+2],17,606105819),d=s(d,h,b,g,l[p+3],22,3250441966),g=s(g,d,h,b,l[p+4],7,4118548399),b=s(b,g,d,h,l[p+5],12,1200080426),h=s(h,b,g,d,l[p+6],17,2821735955),d=s(d,h,b,g,l[p+7],22,4249261313),g=s(g,d,h,b,l[p+8],7,1770035416),b=s(b,g,d,h,l[p+9],12,2336552879),h=s(h,b,g,d,l[p+10],17,4294925233),d=s(d,h,b,g,l[p+11],22,2304563134),g=s(g,d,h,b,l[p+12],7,1804603682),b=s(b,g,d,h,l[p+13],12,4254626195),h=s(h,b,g,d,l[p+14],17,2792965006),g=o(g,d=s(d,h,b,g,l[p+15],22,1236535329),h,b,l[p+1],5,4129170786),b=o(b,g,d,h,l[p+6],9,3225465664),h=o(h,b,g,d,l[p+11],14,643717713),d=o(d,h,b,g,l[p+0],20,3921069994),g=o(g,d,h,b,l[p+5],5,3593408605),b=o(b,g,d,h,l[p+10],9,38016083),h=o(h,b,g,d,l[p+15],14,3634488961),d=o(d,h,b,g,l[p+4],20,3889429448),g=o(g,d,h,b,l[p+9],5,568446438),b=o(b,g,d,h,l[p+14],9,3275163606),h=o(h,b,g,d,l[p+3],14,4107603335),d=o(d,h,b,g,l[p+8],20,1163531501),g=o(g,d,h,b,l[p+13],5,2850285829),b=o(b,g,d,h,l[p+2],9,4243563512),h=o(h,b,g,d,l[p+7],14,1735328473),g=u(g,d=o(d,h,b,g,l[p+12],20,2368359562),h,b,l[p+5],4,4294588738),b=u(b,g,d,h,l[p+8],11,2272392833),h=u(h,b,g,d,l[p+11],16,1839030562),d=u(d,h,b,g,l[p+14],23,4259657740),g=u(g,d,h,b,l[p+1],4,2763975236),b=u(b,g,d,h,l[p+4],11,1272893353),h=u(h,b,g,d,l[p+7],16,4139469664),d=u(d,h,b,g,l[p+10],23,3200236656),g=u(g,d,h,b,l[p+13],4,681279174),b=u(b,g,d,h,l[p+0],11,3936430074),h=u(h,b,g,d,l[p+3],16,3572445317),d=u(d,h,b,g,l[p+6],23,76029189),g=u(g,d,h,b,l[p+9],4,3654602809),b=u(b,g,d,h,l[p+12],11,3873151461),h=u(h,b,g,d,l[p+15],16,530742520),g=i(g,d=u(d,h,b,g,l[p+2],23,3299628645),h,b,l[p+0],6,4096336452),b=i(b,g,d,h,l[p+7],10,1126891415),h=i(h,b,g,d,l[p+14],15,2878612391),d=i(d,h,b,g,l[p+5],21,4237533241),g=i(g,d,h,b,l[p+12],6,1700485571),b=i(b,g,d,h,l[p+3],10,2399980690),h=i(h,b,g,d,l[p+10],15,4293915773),d=i(d,h,b,g,l[p+1],21,2240044497),g=i(g,d,h,b,l[p+8],6,1873313359),b=i(b,g,d,h,l[p+15],10,4264355552),h=i(h,b,g,d,l[p+6],15,2734768916),d=i(d,h,b,g,l[p+13],21,1309151649),g=i(g,d,h,b,l[p+4],6,4149444226),b=i(b,g,d,h,l[p+11],10,3174756917),h=i(h,b,g,d,l[p+2],15,718787259),d=i(d,h,b,g,l[p+9],21,3951481745),g=n(g,y),d=n(d,m),h=n(h,f),b=n(b,v);return 32==t?c(g)+c(d)+c(h)+c(b):c(d)+c(h)}var P=new(function(){function e(){l(this,e),this.sessionId="",this.sessionDate=""}return p(e,[{key:"setId",value:function(){var e=+new Date;return this.sessionId=O("WeChat"+e.toString()+Math.random(0,1e7)),this.sessionDate=e,_.setLocal("SEESIONID",this.sessionId),_.setLocal("SEESIONDATE",this.sessionDate),this.sessionId}},{key:"getId",value:function(){var e=new Date,t=e.getTime(),a=e.getTimezoneOffset(),r=new Date(t+60*a*1e3+288e5).getDate();this.sessionDate=_.getLocal("SEESIONDATE")||0;var n=0===this.sessionDate?0:new Date(this.sessionDate+60*a*1e3+288e5).getDate();return(""===this.sessionId||0===this.sessionDate||Number(t)-Number(this.sessionDate)>18e5||n!==r)&&this.setId(),this.sessionDate=t,_.setLocal("SEESIONDATE",t),this.sessionId=_.getLocal("SEESIONID")||this.setId(),this.sessionId}}]),e}()),N=new(function(){function e(){l(this,e)}return p(e,[{key:"getId",value:function(){var e=_.getLocal("ARK_LOGINID")||_.getLocal("ARK_TRACKID")||_.getLocal("ARK_ID");return e||(e=this.setId(),_.setLocal("ARK_ID",e)),e}},{key:"setId",value:function(){var e=new String((new Date).getTime())+new String(1e4*Math.random());return"QK"+O(new String(e),32)+O(new String(e),32).slice(0,4)}},{key:"jsId",value:function(){var e=_.getLocal("ARK_ID");return e||(e=this.setId()),e}},{key:"removeARKId",value:function(){_.removeLocal("ARK_ID")}},{key:"setLoginId",value:function(e){e&&_.setLocal("ARK_LOGINID",e)}},{key:"setLoginOId",value:function(e){e&&_.setLocal("ARK_LOGINOID",e)}},{key:"getLoginOId",value:function(){return _.getLocal("ARK_LOGINOID")}},{key:"getLoginId",value:function(){return _.getLocal("ARK_LOGINID")}},{key:"removeLoginId",value:function(){_.removeLocal("ARK_LOGINID")}},{key:"setTrackId",value:function(e){e&&_.setLocal("ARK_TRACKID",e)}},{key:"getTrackId",value:function(){return _.getLocal("ARK_TRACKID")}},{key:"removeTrackId",value:function(){_.removeLocal("ARK_TRACKID")}},{key:"getAliasId",value:function(){return _.getLocal("ARK_LOGINID")}},{key:"removeAliasId",value:function(){_.removeLocal("ARK_LOGINID")}},{key:"setIdentifyId",value:function(e){_.setLocal("ARK_TRACKID",e)}},{key:"getIdentifyId",value:function(){return _.getLocal("ARK_TRACKID")}},{key:"removeIdentifyId",value:function(){_.removeLocal("ARK_TRACK_LOGIN")}}]),e}()),D={utm_campaign_id:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:"",utm_campaign:""},w=T.Router.getPath,F=T.Router.getScene,j=(T.Router.getPackageName,T.Router.getTitle,T.Router.getReferer),C=u.base;function x(){return u.system.system.language||""}var M="GMT"+$.clientTimeZone();function K(){var e=$.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");return u.base.allowTimeCheck&&u.base.logflag&&(e=$.format(new Date(+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)),"yyyy-MM-dd hh:mm:ss.SSS")),_.getLocal("ARKFRISTPROFILE")&&(e=_.getLocal("ARKFRISTPROFILE")),e}var U=_.getData("UTMSESSION")||"";D.utm_campaign&&D.utm_source&&D.utm_medium?(U!==JSON.stringify(D)&&P.setId(),_.setData("UTMSESSION",JSON.stringify(D))):(D={utm_campaign_id:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:"",utm_campaign:""},_.removeData("UTMSESSION"));var V={resetKeywords:["appid","$debug","uploadUrl"],uploadURL:{valueType:0,value:function(e){return"/"!==C.uploadURL.charAt(C.uploadURL.length-1)&&(C.uploadURL+="/"),C.uploadURL},check:{value:["isString","nimLength","isUrl"],errorCode:"60007",successCode:"20008"}},appid:{valueType:0,value:function(){return C.appid},check:{value:["isString","nimLength"],errorCode:"60006",successCode:"20006"}},auto:{check:{value:["isBoolean"],errorCode:"60003"}},autoProfile:{check:{value:["isBoolean"],errorCode:"60003"}},xwho:{valueType:0,value:function(){return N.getId()},check:{value:["isString","nimLength"]}},xwhen:{valueType:0,value:function(){return u.base.allowTimeCheck&&u.base.logflag?+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0):+new Date}},xwhat:{valueType:0,value:function(){return u.status.FnName},check:{value:["isString","nimLength"]}},xcontext:{$lib:{valueType:1,value:"Quickapp"},$lib_version:{valueType:0,value:function(){return C.$lib_version},check:{value:["isString"],successCode:"20007"}},$platform:{valueType:1,value:"Quickapp"},$debug:{valueType:0,value:function(){return C.$debug},check:{value:["isNumber","isDebug"]}},$is_login:{valueType:0,value:function(){return!(!N.getAliasId()&&!_.getLocal("ARK_TRACK_LOGIN"))},check:{value:["isBoolean"]}},$screen_width:{valueType:0,value:function(){return u.system.system.screenWidth||""},check:{value:["isNumber"]}},$screen_height:{valueType:0,value:function(){return u.system.system.screenHeight||""},check:{value:["isNumber"]}},$time_zone:{valueType:1,value:M},$os:{valueType:0,value:function(){return u.system.system.system?u.system.system.system.split(" ")[0]:""},check:{value:["isString"]}},$browser:{valueType:0,value:function(){return u.system.system.browser||""}},$brand:{valueType:0,value:function(){return u.system.system.brand||""},check:{value:["isString"]}},$browser_version:{valueType:0,value:function(){return u.system.system.version||""},check:{value:["isString"]}},$os_version:{valueType:0,value:function(){return u.system.system.system?u.system.system.system.split(" ")[1]:""},check:{value:["isString"]}},$model:{valueType:0,value:function(){return u.system.system.model||""},check:{value:["isString"]}},$language:{valueType:0,value:x,check:{value:["isString"]}},$network:{valueType:0,value:function(){return u.system.netWork.networkType},check:{value:["isString"]}},$session_id:{valueType:0,value:function(){return P.getId()}},$scene:{valueType:0,value:F},$referrer:{valueType:0,value:function(){return j()||F()}},$startup_time:{valueType:0,value:K},$is_first_time:{valueType:0,value:function(){var e=_.getLocal("FRISTIME");return _.setLocal("FRISTIME",!1),null==e||e}},$is_first_day:{valueType:0,value:function(){var e=new Date;u.base.allowTimeCheck&&u.base.logflag&&(e=new Date(+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)));var t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var r=e.getDate(),n=t+""+a+(r=r<10?"0"+r:r),s=_.getLocal("FRISTDAY");return!(s&&n!==s||(_.setLocal("FRISTDAY",n),0))}},$first_visit_time:{valueType:0,value:K},$original_id:{valueType:0,value:function(){return N.getTrackId()||N.jsId()},check:{value:["isString"]}},$is_time_calibrated:{valueType:0,value:function(){return!!(_.getLocal("ANSSERVERTIME")&&u.base.allowTimeCheck&&u.base.logflag)}},$url:{valueType:0,value:function(){return w()||""}},$utm_campaign_id:{valueType:0,value:function(){return D.utm_campaign_id}},$utm_source:{valueType:0,value:function(){return D.utm_source}},$utm_medium:{valueType:0,value:function(){return D.utm_medium}},$utm_term:{valueType:0,value:function(){return D.utm_term}},$utm_content:{valueType:0,value:function(){return D.utm_content}},$utm_campaign:{valueType:0,value:function(){return D.utm_campaign}},$share_id:{valueType:0,value:function(){return u.base.$share_id}},$share_level:{valueType:0,value:function(){var e=parseInt(u.base.$share_level);return 0===e||e?e:""}},$share_path:{valueType:0,value:function(){return u.base.$share_path}},$element_content:{valueType:0,value:function(){var e=u.base.userObj,t=u.base.userPageObj;return e.currentTarget?(e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.content||"")+"":(t.text||"")+""}},$element_id:{valueType:0,value:function(){var e=u.base.userObj;return(e.currentTarget&&e.currentTarget.id||"")+""}},$element_type:{valueType:0,value:function(){var e=u.base.userObj;return(e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.type||"")+""}},$element_name:{valueType:0,value:function(){var e=u.base.userObj;return(e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.name||"")+""}}},xcontextCommonRule:{check:{key:["isString","length99","notSpecialCharacters","keywords"],value:["notObject","isArrayString","length255"]}},$track:{check:{key:["isString","notSpecialCharacters","length99"]}},$alias:{check:{key:["isString","keyLength255"]}},$profile_increment:{check:{key:["isString","length99","notSpecialCharacters"],value:["isNumber"]}},$profile_unset:{check:{key:["isString","length99","notSpecialCharacters"]}},$pageview:{check:{key:["isString","keyLength255"]}}};function Y(e,t){for(var a=0;a<t.length;a++)if(!I[t[a]](e))return!1;return!0}function q(e,t,a){var r=a.check,n=!0;if(!r)return n;var s=r.key,o=r.value;if(s&&(n=Y(e,s),u.status.key=e,n||(u.status.code=400,E())),o){if(u.status.code=200,t&&"Array"==$.paramType(t)){u.status.key=e;for(var i=0;i<t.length;i++)(n=Y(t[i],["isString","length255"]))||(u.status.value=t[i],"String"!==$.paramType(t[i])&&(u.status.errorCode="600013"),t[i].length>500&&(t[i]=$.stringSlice(t[i],499)+"$"),u.status.code=400,E());return n}n=Y(t,o),"Array"!==$.paramType(t)&&(u.status.value=t),n||(u.status.code=400,E())}return n}function G(e,t){var a=t||V,r={};for(var n in e){var s=e[n],o=a[n];if(o){var u="";if("Object"===$.paramType(s)){var i=G(s,o);r[n]=i}else $.objHasKay(o,"valueType")&&(0===o.valueType&&(u=o.value(),"String"==$.paramType(u)&&u.length>500?r[n]=$.stringSlice(u,499)+"$":r[n]=u),1===o.valueType&&(u=o.value,"String"==$.paramType(u)&&u.length>500?r[n]=$.stringSlice(u,499)+"$":r[n]=u))}}return r}function J(){u.status={code:200,FnName:u.status.FnName,key:"",value:"",errorCode:"",successCode:""}}function W(e,t,a,r){J();var n=V[t]||V.xcontextCommonRule;if("Object"!==$.paramType(e)||1==a){var s=Y(e,n.check.key);return u.status.key=e,!(!s&&(E(),"aliasId"==r||"distinctId"==r))}for(var o in 0==Object.keys(e).length&&(u.status.errorCode=600021,u.status.value=0,E()),e)s=q(o,e[o],n),"$lib"!=o&&"$lib_version"!=o&&"$platform"!=o||(e[o]=u.base[o]),s||"600019"===u.status.errorCode&&e[o].length>500&&(e[o]=$.stringSlice(e[o],499)+"$");return!0}for(var B=[],z=o||{},H=0;H<B.length;H++)z=$.objMerge(o,B[H]);var Z={},Q={},X=z.base,ee=X.outer;for(H=0;H<ee.length;H++)X[ee[H]]?Q[ee[H]]=$.toObj(X[ee[H]]):Q[ee[H]]="";for(var te in z)"base"!=te&&(Z[te]=$.objMerge(Q,$.toDeepObj(z[te])));function ae(e){return Z[e]||Z.commonTemp}Z.commonTemp=Q;var re=T.getPublicApp,ne=T.Fetch.request,se=!0;function oe(e){if("Object"===$.paramType(e)&&!$.isEmptyObject(e)){for(var t=!0,a=0;a<u.baseJson.length;a++){var r=u.baseJson[a];"xwhat"!==r&&(!e[r]||"Object"==$.paramType(e[r])&&$.isEmptyObject(e[r]))&&(t=!1)}return t}return!1}function ue(e){if(""==u.base.appid)return u.status.errorCode="60006",void E();if(""===u.base.uploadURL)return u.status.errorCode="60007",void E();var t=_.getLocal("POSTDATA")||[],a=[];if(t.length>0)for(var r=0;r<t.length;r++)"Array"===$.paramType(t[r])?a.push.apply(a,t[r]):"Object"===$.paramType(t[r])&&oe(t[r])&&a.push(t[r]);t.length<=500&&Object.keys(e).length>0&&a.push(e),_.setLocal("POSTDATA",a),!0===se&&function e(t){_.removeLocal("POSTDATA"),J(),se=!1;var a=t,r={url:u.base.uploadURL+"?appid="+u.base.appid,data:t,encryptType:u.base.encryptType};re()&&re().AnalysysAgent.encrypt&&"Function"===$.paramType(re().AnalysysAgent.encrypt.uploadData)&&(r=re().AnalysysAgent.encrypt.uploadData(r)),u.status.key=r.url,u.status.value=JSON.stringify(t),u.status.successCode="20012",L(),ne({url:r.url,method:"POST",data:JSON.stringify(r.data),dataType:u.base.dataType||"json",success:function(t){if(se=!0,"String"==$.paramType(t.data)&&(re().AnalysysAgent.encrypt&&"Function"==$.paramType(re().AnalysysAgent.encrypt.decodeRes)?t.data=JSON.parse(re().AnalysysAgent.encrypt.decodeRes(t.data)):"H4sIAAAAAAAAAKtWSs5PSVWyMjIwqAUAVAOW6gwAAAA="==t.data?t.data={code:200}:"H4sIAAAAAAAAAKtWSs5PSVWyMjUwqAUA7TtBdwwAAAA="==t.data?t.data={code:500}:"H4sIAAAAAAAAAKtWSs5PSVWyMjEy0FHKLU5XslJySSxJVHBJTS6qLChRcC0qyi/S01OqBQBdATGSKQAAAA=="==t.data?t.data={code:420}:t.data={code:200}),200==t.data.code||500==t.data.code||420==t.data.code){var r=_.getLocal("POSTDATA")||[];r.length>0&&e(r),200==t.data.code?(u.status.successCode="20001",L()):(u.status.errorCode="60008",E())}else{u.status.errorCode="60008",E();var n=_.getLocal("POSTDATA")||[],s=[].concat(m(a),m(n));_.setLocal("POSTDATA",s),n.length>0&&e(s)}},fail:function(){se=!0,u.status.errorCode="60008",E();var t=_.getLocal("POSTDATA")||[],r=[].concat(m(a),m(t));_.setLocal("POSTDATA",r),t.length>0&&e(r)}})}(a)}function ie(e,t){u.status.FnName="$profile_set_once",J();var a=$.toObj(e,t);W(a);var r=G(ae("$profile_set_once"));(r=$.delEmpty(r)).xcontext=$.objMerge(r.xcontext,a),ue(r)}function ce(e,t){u.status.FnName="$pageview",J();var a={$title:""};arguments.length>0&&W(a={$title:e}),arguments.length>1&&W(t);var r=G(ae("$pageview"));r=$.delEmpty(r);var n=_.getLocal("ARKSUPER")||{};Object.keys(n).length>0&&(r.xcontext=$.objMerge(r.xcontext,n));var s=u.base.appProperty;"Object"==$.paramType(s)&&s&&(r.xcontext=$.objMerge(r.xcontext,s)),r.xcontext=$.objMerge(r.xcontext,t||{}),e&&"String"==$.paramType(e)&&(r.xcontext=$.objMerge(r.xcontext,a||{})),ue(r)}function le(e){var t=$.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");u.base.allowTimeCheck&&u.base.logflag&&(t=$.format(new Date(+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)),"yyyy-MM-dd hh:mm:ss.SSS"));var a={$first_visit_time:_.getLocal("ARKFRISTPROFILE")||t,$first_visit_language:x()},r=u.base.autoProfile,n=u.base.auto;if("startUp"==e){if(!0===r&&0==(_.getLocal("ARKFRISTPROFILESEND")||!1)){_.setLocal("ARKFRISTPROFILESEND",!0),u.status.FnName="$profile_set_once",J();var s=G(ae("$profile_set_once"));(s=$.delEmpty(s)).xcontext=$.objMerge(s.xcontext,a);var o=_.getLocal("POSTDATA");o=[].concat(m(o),m($.objInArray(s))),_.setLocal("POSTDATA",o)}!0===n?ce():ue({})}else{if("alias"!=e)return;1==u.base.autoProfile&&(_.setLocal("ARKFRISTPROFILESEND",!0),ie(a))}}var pe=T.setPublicApp;function ye(e){e&&function(e){var t=e;e&&"create"==e._status&&(pe(e),t=e.options),t.query&&Object.keys(t.query).length>0&&(t.query.utm_campaign&&t.query.utm_medium&&t.query.utm_source&&(D.utm_campaign_id=t.query.campaign_id,D.utm_campaign=t.query.utm_campaign,D.utm_content=t.query.utm_content,D.utm_medium=t.query.utm_medium,D.utm_source=t.query.utm_source,D.utm_term=t.query.utm_term),t.query.share_id&&t.query.share_level&&t.query.share_path&&(u.base.$share_id=t.query.share_id,u.base.$share_level=t.query.share_level,u.base.$share_path=decodeURIComponent(t.query.share_path))),t.scene&&(u.system.scene=e.scene)}(e);var t=_.getLocal("ARKAPPID"),a=_.getLocal("ARKDEBUG"),r=_.getLocal("ARKUPLOADURL");if(t&&"Number"==$.paramType(a)&&r&&(t!==u.base.appid||1===a&&a!==u.base.$debug||r!==u.base.uploadURL)&&($.delFristDay(),$.delFristTime(),_.removeLocal("ARKFRISTPROFILE"),_.removeLocal("ARKFRISTPROFILESEND"),N.removeLoginId(),N.removeTrackId(),_.removeLocal("ARK_TRACK_LOGIN"),_.removeLocal("ARKSUPER"),_.removeData("STARTUP"),_.removeData("STARTUPTIME"),_.removeLocal("POSTDATA")),$.setFristDay(),$.setFristTime(),u.base.allowTimeCheck||_.removeLocal("ANSSERVERTIME"),_.setLocal("ARKDEBUG",u.base.$debug),_.setLocal("ARKAPPID",u.base.appid),_.setLocal("ARKUPLOADURL",u.base.uploadURL),!1!==_.getData("STARTUP")){for(var n=u.FnSuperCatch,s=0;s<n.length;s++)n[s][0].apply(n[s][0],n[s][1]);u.FnSuperCatch=[],u.isStartUp=!0,u.status.FnName="$startup",J(),P.setId(),_.setData("STARTUP",!1);var o=G(ae("$startup"));o=$.delEmpty(o),_.getLocal("ARKFRISTPROFILE")||_.setLocal("ARKFRISTPROFILE",$.format(new Date(o.xwhen),"yyyy-MM-dd hh:mm:ss.SSS"));var i=_.getLocal("ARKSUPER")||{};o.xcontext=$.objMerge(o.xcontext,i);var c=u.base.appProperty||{};if(o.xcontext=$.objMerge(o.xcontext,c),_.setData("STARTUPTIME",$.format(new Date(o.xwhen),"yyyy-MM-dd hh:mm:ss.SSS")),1!=u.base.autoProfile&&1!=u.base.auto)ue(o);else{var l=_.getLocal("POSTDATA")||[];l=[].concat(m(l),m($.objInArray(o))),_.setLocal("POSTDATA",l),le("startUp")}var p=u.FnCatch;for(s=0;s<p.length;s++)p[s][0].apply(p[s][0],p[s][1]);u.FnCatch=[]}else 1==u.base.auto&&ce()}function me(e,t){u.status.FnName="$registerSuperProperty",J();var a=$.toObj(e,t);W(a);var r=_.getLocal("ARKSUPER")||{},n=$.objMerge(r,a);_.setLocal("ARKSUPER",n),u.status.successCode="20002",u.status.value=JSON.stringify(a),L()}function fe(e){u.status.FnName="$unregisterSuperProperty",J(),W(e);var t=_.getLocal("ARKSUPER")||{};if(!t.hasOwnProperty(e))return u.status.successCode="20011",u.status.value=e,void L();delete t[e],_.setLocal("ARKSUPER",t),u.status.successCode="20003",u.status.value=e,L()}function ve(e,t){u.status.FnName="$registerSuperProperties",J();var a=$.toObj(e,t);W(a);var r=_.getLocal("ARKSUPER")||{},n=$.objMerge(r,a);_.setLocal("ARKSUPER",n),u.status.successCode="20002",u.status.value=JSON.stringify(a),L()}function ge(e){u.status.FnName="$getSuperProperty",J(),W(e,"$getSuperProperty",!0);var t=_.getLocal("ARKSUPER")||{},a=t[e];return t.hasOwnProperty(e)?(u.status.successCode="20010",u.status.value=a,u.status.key=e,L(),a):(u.status.successCode="20009",u.status.key=e,L(),"")}function de(){u.status.FnName="$getSuperProperties",J();var e=_.getLocal("ARKSUPER")||{};return u.status.successCode="20010",u.status.value=JSON.stringify(e),L(),e}function he(){u.status.FnName="$clearSuperProperties",J(),_.setLocal("ARKSUPER",{}),u.status.successCode="20004",L()}function be(e){if(u.status.FnName="$alias",J(),W(e,"$alias",!0,"aliasId")){_.setLocal("ARK_LOGINID",e);var t=G(ae("$alias"));t=$.delEmpty(t),1!=u.base.autoProfile?ue(t):(_.setLocal("POSTDATA",$.objInArray(t)),le("alias"))}}function Te(e,t){u.status.FnName=e,J(),W(e,"$track",!0),arguments.length>1&&W(t);var a=G(ae("$track")),r=_.getLocal("ARKSUPER")||{};a.xcontext=$.delEmpty(a.xcontext),Object.keys(r).length>0?(r=$.objMerge(r,t),a.xcontext=$.objMerge(a.xcontext,r)):a.xcontext=$.objMerge(a.xcontext,t),ue(a)}function Se(e,t){u.status.FnName="$identify",J(),W(e,"$alias",!0,"distinctId")&&(!0===t&&_.setLocal("ARK_TRACK_LOGIN",!0),_.setLocal("ARK_TRACKID",e),u.status.successCode="20002",u.status.value=e,L())}function Ae(){var e=$.format(new Date,"yyyy-MM-dd hh:mm:ss.SSS");u.base.allowTimeCheck&&u.base.logflag&&(e=+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)),e=$.format(new Date(e),"yyyy-MM-dd hh:mm:ss.SSS"),J(),N.removeARKId(),N.removeTrackId(),N.removeLoginId(),N.removeIdentifyId(),he(),function(e){if(!(e=e||!1)){var t=u.base;for(var a in t)"Object"!==$.paramType(t[a])&&("$debug"!==a&&"appid"!==a&&"uploadURL"!==a||(Storage.getLocal("ANS"+a.toUpperCase())!==t[a]&&(e=!0),e&&Storage.setLocal("ANS"+a.toUpperCase(),t[a])))}if(e){if(_.removeLocal("ARKSUPER"),_.removeData("STARTUP"),_.setLocal("FRISTDAY",$.format(new Date,"yyyyMMdd")),u.base.allowTimeCheck&&u.base.logflag){var r=$.format(new Date(+new Date+(_.getLocal("ANSSERVERTIME")?Number(_.getLocal("ANSSERVERTIME")):0)),"yyyyMMdd");_.setLocal("FRISTDAY",r)}_.setLocal("FRISTIME",!0),_.removeLocal("POSTDATA"),_.removeLocal("ANSSERVERTIME"),_.removeLocal("ARKFRISTPROFILE"),_.removeLocal("ARKFRISTPROFILESEND")}}(!0),P.setId(),!0===u.base.autoProfile&&ie({$reset_time:e}),u.status.FnName="$reset",u.status.successCode="20005",L()}function _e(e,t){u.status.FnName="$profile_set",J();var a=$.toObj(e,t);W(a);var r=G(ae("$profile_set"));(r=$.delEmpty(r)).xcontext=$.objMerge(r.xcontext,a),ue(r)}function $e(e,t){u.status.FnName="$profile_increment",J();var a=$.toObj(e,t);W(a,"$profile_increment");var r=G(ae("$profile_increment"));(r=$.delEmpty(r)).xcontext=$.objMerge(r.xcontext,a),ue(r)}function ke(e,t){u.status.FnName="$profile_append",J();var a=$.toObj(e,t);W(a);var r=G(ae("$profile_append"));(r=$.delEmpty(r)).xcontext=$.objMerge(r.xcontext,a),ue(r)}function Re(e){u.status.FnName="$profile_unset",J();var t=$.toObj(e,"");W(t,"$profile_unset");var a=G(ae("$profile_unset"));(a=$.delEmpty(a)).xcontext=$.objMerge(a.xcontext,t),ue(a)}function Le(){u.status.FnName="$profile_delete",J();var e=G(ae("$profile_delete"));ue(e=$.delEmpty(e))}var Ee=T.Fetch.request,Ie=function(){return new Promise((function(e){if(J(),!u.base.allowTimeCheck)return e();var t=u.base.uploadURL;t=t.split("up")[0],Ee({url:t+"configure",method:"GET",success:function(t){e(t);var a=t.header||t.headers;if(a&&a.Date){var r=+new Date,n=a.Date,s=u.base.maxDiffTimeInterval;s<0&&(s=30),n&&s<Math.abs((+new Date(n)-r)/1e3)&&(u.base.logflag||(_.setLocal("ANSSERVERTIME",+new Date(n)-r),u.status.successCode="20013",u.status.value=$.format(new Date(n),"yyyy-MM-dd hh:mm:ss +SSS"),u.status.key=$.format(new Date(r),"yyyy-MM-dd hh:mm:ss +SSS"),u.status.FnName=(+new Date(n)-r)/1e3+"s",L(),u.base.logflag=!0))}},fail:function(t){e(t)}})})).catch((function(e){}))},Oe=T.System.systemPromise,Pe=T.Network.netWorkPromise;function Ne(e,t){var a=N.getId(),r=T.Router.getPath();"Object"!==$.paramType(e)&&(e={path:r}),Promise.all([Oe(),Pe(),Ie(),_.initLocalData()]).then((function(e){var n=parseInt(u.base.$share_level)?parseInt(u.base.$share_level):"",s={$share_id:a,$share_level:Number(n)+1,$share_path:r};"Object"===$.paramType(t)&&(s=$.objMerge(s,t)),Te("$share",s)}));var n="share_id="+a+"&share_level="+(Number(u.base.$share_level)+1)+"&share_path="+encodeURIComponent(r);return e.path=e.path||r,e.path.indexOf("?")>-1?e.path=e.path+"&"+n:e.path=e.path+"?"+n,e}function De(e){if(J(),u.status.FnName="$appProperty","Object"!=$.paramType(e)||!e)return u.status.errorCode="600016",u.status.value=JSON.stringify(e),void E();if(W(e),u.base.appProperty)for(var t in e)u.base.appProperty[t]=e[t];else u.base.appProperty=e;u.status.successCode="20002",u.status.value=JSON.stringify(e),L()}function we(){return N.getTrackId()||N.jsId()}function Fe(){u.status.FnName="getPresetProperties",J();var e=G(ae("$getPresetProperties"));return delete(e=$.delEmpty(e)).xcontext.$is_login,u.status.successCode="20010",u.status.value=JSON.stringify(e.xcontext),L(),e.xcontext}var je=T.System.systemPromise,Ce=T.Network.netWorkPromise,xe=!0,Me=[];function Ke(e,t,a){return function(){var r=arguments;1!=xe||0!==Object.keys(u.system.system).length&&0!==Object.keys(u.system.netWork).length?!t&&1!=u.isStartUp||1!=xe?1==a?u.FnSuperCatch.push([e,arguments]):1==xe&&!1===a?Me.push([e,arguments]):u.FnCatch.push([e,arguments]):e.apply(e,arguments):Promise.all([je(),Ce(),Ie(),_.initLocalData()]).then((function(n){xe=!0,u.system.system=n[0],u.system.netWork=n[1],Me.length>0&&(Me[0][0](Me[0][1]),Me=[]),a&&1!=u.isStartUp?u.FnSuperCatch.push([e,r]):t||1==u.isStartUp?e.apply(e,r):u.FnCatch.push([e,r])})).catch((function(e){}))}}var Ue=function e(){l(this,e),this.appStart=Ke(ye,!0,!1),this.startUp=Ke(ye,!0),this.pageView=Ke(ce,!1),this.registerSuperProperty=Ke(me,!1,!0),this.unRegisterSuperProperty=Ke(fe,!1,!0),this.registerSuperProperties=Ke(ve,!1,!0),this.getSuperProperty=ge,this.getSuperProperties=de,this.clearSuperProperties=Ke(he,!1,!0),this.alias=Ke(be,!0),this.track=Ke(Te,!1),this.identify=Ke(Se,!1,!0),this.reset=Ae,this.profileSet=Ke(_e,!1),this.profileSetOnce=Ke(ie,!1),this.profileIncrement=Ke($e,!1),this.profileAppend=Ke(ke,!1),this.profileUnset=Ke(Re,!1),this.profileDelete=Ke(Le,!1),this.share=Ne,this.appProperty=De,this.getDistinctId=we,this.getPresetProperties=Fe},Ve=T.getPublicApp;u.isStartUp=!0,u.base.auto=!1;var Ye=new(function(e){function t(){return l(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ue),p(t,[{key:"appkey",set:function(e){return J(),"String"!==$.paramType(e)?(u.status.FnName="appkey",u.status.errorCode="60001",u.status.key=e,void E()):""==e?(u.status.FnName="appkey",u.status.errorCode="60006",void E()):(u.base.appid=e,u.status.FnName="appkey",u.status.successCode="20002",u.status.value=e,L(),u.status.successCode="20007",u.status.value=u.base.$lib_version,void L())},get:function(){return u.base.appid}},{key:"debugMode",set:function(e){J(),u.base.$debug=e},get:function(){return u.base.$debug}},{key:"uploadURL",set:function(e){return J(),e?$.checkURL(e)?("/"!==e.charAt(e.length-1)&&(e+="/"),u.base.uploadURL=e+"up",u.status.successCode="20008",u.status.value=e,void L()):(u.status.errorCode="600011",u.status.key="uploadURL",u.status.value=e,void E()):(u.status.errorCode="60007",void E())},get:function(){return u.base.uploadURL}},{key:"autoProfile",set:function(e){if(J(),"Boolean"!==$.paramType(e))return u.status.key="autoProfile",u.status.errorCode="60003",u.status.value=e,void E();u.base.autoProfile=e},get:function(){return u.base.autoProfile}},{key:"encryptType",set:function(e){if(J(),"Number"!==$.paramType(e))return u.status.key="encryptType",u.status.errorCode="60002",u.status.value=e,void E();u.base.encryptType=e},get:function(){return u.base.encryptType}},{key:"autoShare",set:function(e){if(J(),"Boolean"!==$.paramType(e))return u.status.key="autoShare",u.status.errorCode="60003",u.status.value=e,void E();u.base.autoShare=e},get:function(){return u.base.autoShare}},{key:"allowTimeCheck",set:function(e){if(J(),"Boolean"!==$.paramType(e))return u.status.key="allowTimeCheck",u.status.errorCode="60003",u.status.value=e,void E();u.base.allowTimeCheck=e},get:function(){return u.base.allowTimeCheck}},{key:"maxDiffTimeInterval",set:function(e){if(J(),"Number"!==$.paramType(e))return u.status.key="maxDiffTimeInterval",u.status.errorCode="60002",u.status.value=e,void E();u.base.maxDiffTimeInterval=e},get:function(){return u.base.maxDiffTimeInterval}},{key:"requestDataType",set:function(e){if(J(),"String"!==$.paramType(e))return u.status.FnName="requestDataType",u.status.errorCode="60001",u.status.key=e,void E();var t=e.toLowerCase();["json","text","base64","arraybuffer"].indexOf(t)>-1?(u.status.FnName="requestDataType",u.status.successCode="20002",u.status.value=t,L(),u.base.dataType=t):(u.status.FnName="requestDataType",u.status.errorCode="600022",u.status.key=e,E())},get:function(){return u.base.dataType}}]),t}());delete Ye.startUp;var qe=Ve();qe&&(qe.AnalysysAgent=Ye);export default Ye;
